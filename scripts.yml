envFile:
  - .env
env:
  PORT: "8000"

scripts:
  setup:
    desc: Download dependencies
    cmd: deno cache --reload --lock=lock.json --lock-write src/deps.ts
  start:
    desc: Runs server
    cmd: deno run --import-map=import_map.json --allow-net=0.0.0.0:8000 --allow-env src/server.ts
    watch: true
  lint:
    desc: Analyze code with default deno linter
    cmd: deno lint
  format: deno fmt
  pre-commit:
    cmd:
      - vr lint
      - vr format
    gitHook: pre-commit
  test:
    desc: Runs test suite
    cmd: deno test --import-map=import_map.json -A
  compile:
    desc: Compile project in a self contained executable
    cmd:
      - rm -rf dist
      - mkdir dist
      - deno compile --import-map=import_map.json --allow-net=0.0.0.0:8000 --allow-env --output dist/app src/server.ts
